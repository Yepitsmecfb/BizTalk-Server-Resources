{"version":"1.1","environment":{"id":"63420540-7c37-4ae6-adde-5cddc3f30c70","name":"BTS2016LAB01","mgmtDbSqlInstanceName":"BTS2016LAB01","mgmtDbName":"BizTalkMgmtDb","licenseKey":"cm9QZXJlaXJhfGNvdW50cnk6UG9ydHVnYWx8bWF4QXBwbGljYXRpb25zOjUwfG1heEJpelRhbGtT","licenseEdition":8,"isLicenseActive":false,"colorCode":"#ed9d71","isEnvironmentAvailable":false},"usedEnvironmentMetaData":{"biztalkServerNames":[],"sqlServerNames":[],"sqlServerInstanceNames":["BTS2016LAB01"],"eventLogServerNames":[]},"alarmConfigurations":[{"alarm":{"alarmId":"f19392c6-cda0-477b-ab2f-b4030a29654f","name":"Alarm1","commaSeparatedEmails":"sandro.pereira@devscope.net","commaSeparatedSMSNumbers":"","isTestMode":false,"isAlertASAP":false,"alertASAPWaitDurationInMinutes":10,"alertASAPErrorDetectionCount":0,"isContinuousErrorRestricted":true,"continuousErrorMaxCount":3,"isAlertOnCorrection":true,"daysOfWeek":{"Mon":false,"Tue":false,"Wed":false,"Thu":false,"Fri":true,"Sat":false,"Sun":false},"timeOfDays":{"Zero":false,"One":false,"Two":false,"Three":false,"Four":false,"Five":false,"Six":false,"Seven":false,"Eight":false,"Nine":true,"Ten":false,"Eleven":false,"Twelve":false,"Thirteen":false,"Fourteen":false,"Fifteen":false,"Sixteen":false,"Seventeen":false,"Eighteen":false,"Nineteen":false,"Twenty":false,"TwentyOne":false,"TwentyTwo":false,"TwentyThree":false},"isAlertHPOMEnabled":false,"isAlertRestEndpointEnabled":false,"isAlertEventVwrEnabled":false,"eventId":"","isAlertDisabled":false,"createdBy":"BTS2016LAB01\\Administrator","description":"","isThresholdRestricted":false,"thresholdRestrictStartTime":"0001-01-02T00:00:00","thresholdRestrictEndTime":"0001-01-02T00:00:00","isAlertProcessMonitoring":false,"isAlertProcessMonitoringOnSuccess":false,"isAlertHealthMonitoring":true,"isAlertHasMappings":false,"errorsCount":0,"warningsCount":0,"emailTemplateId":1,"emailTemplateName":"BizTalk360 Email Template","isHighImportanceEmail":false},"mappings":{},"processMonitors":[],"mbqDataMonitors":[],"tdqDataMonitors":[],"bamDataMonitors":[],"esbDataMonitors":[],"ediDataMonitors":[],"logicAppsDataMonitors":[],"eventLogDataMonitors":[],"overwriteExistingAlarm":0},{"alarm":{"alarmId":"829ce777-d186-4665-9601-120e0d9fe9bf","name":"BRE Undeployed policies","commaSeparatedEmails":"sandro.pereira@devscope.net","commaSeparatedSMSNumbers":"","isTestMode":true,"isAlertASAP":true,"alertASAPWaitDurationInMinutes":10,"alertASAPErrorDetectionCount":0,"isContinuousErrorRestricted":true,"continuousErrorMaxCount":3,"isAlertOnCorrection":true,"daysOfWeek":{"Mon":false,"Tue":false,"Wed":false,"Thu":false,"Fri":false,"Sat":false,"Sun":false},"timeOfDays":{"Zero":false,"One":false,"Two":false,"Three":false,"Four":false,"Five":false,"Six":false,"Seven":false,"Eight":false,"Nine":false,"Ten":false,"Eleven":false,"Twelve":false,"Thirteen":false,"Fourteen":false,"Fifteen":false,"Sixteen":false,"Seventeen":false,"Eighteen":false,"Nineteen":false,"Twenty":false,"TwentyOne":false,"TwentyTwo":false,"TwentyThree":false},"isAlertHPOMEnabled":false,"isAlertRestEndpointEnabled":false,"isAlertEventVwrEnabled":false,"eventId":"","isAlertDisabled":true,"createdBy":"BTS2016LAB01\\Administrator","description":"","isThresholdRestricted":false,"thresholdRestrictStartTime":"0001-01-02T00:00:00","thresholdRestrictEndTime":"0001-01-02T00:00:00","isAlertProcessMonitoring":false,"isAlertProcessMonitoringOnSuccess":false,"isAlertHealthMonitoring":false,"isAlertHasMappings":true,"errorsCount":0,"warningsCount":0,"emailTemplateId":1,"emailTemplateName":"BizTalk360 Email Template","isHighImportanceEmail":false},"mappings":{"biztalkEnvironment":[{"groupName":"BizTalk Environment","pluginName":"Database Query","serializedMonitorConfig":"<DatabaseQueries xmlns=\"http://www.kovai.co.uk/biztalk360/schemas/plugin/DatabaseQuery\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"><databaseQueries><currentMonitoringStatus>Error</currentMonitoringStatus><currentReturnValue>1</currentReturnValue><errorCondition><expectedValue>0</expectedValue><queryOperator>IsGreaterThan</queryOperator></errorCondition><id>8ee3c051-a6cc-42e5-87cf-1706ee5e3acb</id><name>Undeployed BRE policies (highest versions)</name><sqlDatabaseName>BizTalkRuleEngineDb</sqlDatabaseName><sqlInstanceName>BTS2016LAB01</sqlInstanceName><sqlQuery>;with \ncteHist as (\n\tselect h.* from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] h\njoin (select strname, max(dttimestamp) as dttimestamp from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] group by strname) q on h.strName=q.strName and h.dtTimeStamp=q.dttimestamp\n),\nctetDeployed as (\n\tSELECT StrName, nMajor, nMinor, nStatus\n\t\t\t\t\t\tFROM   (\n\t\t\t\t\t\t   SELECT StrName, nMajor, nMinor, nStatus\n\t\t\t\t\t\t\t\t, row_number() OVER(PARTITION BY StrName ORDER BY nMajor, nMinor DESC) AS rn\n\t\t\t\t\t\t   FROM   [BizTalkRuleEngineDb].[dbo].[re_ruleset]\n\t\t\t\t\t\t   ) sub\n\t\t\t\t\t\tWHERE  rn = 1\n)\nselect COUNT(*) as Count from ctetDeployed d\nwhere exists (select 1 from cteHist h  where h.strName=d.strname and bDeployedInd=0)</sqlQuery><warningCondition><expectedValue>0</expectedValue><queryOperator>IsGreaterThan</queryOperator></warningCondition></databaseQueries><databaseQueries><currentMonitoringStatus>Good</currentMonitoringStatus><currentReturnValue>1</currentReturnValue><errorCondition><expectedValue>0</expectedValue><queryOperator>IsGreaterThan</queryOperator></errorCondition><id>471d7baf-6b0d-4fce-aaae-d21f5617114f</id><name>Highest versions BRE policies in SAVED state</name><sqlDatabaseName>BizTalkRuleEngineDb</sqlDatabaseName><sqlInstanceName>BTS2016LAB01</sqlInstanceName><sqlQuery>;with \ncteHist as (\n\tselect h.* from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] h\njoin (select strname, max(dttimestamp) as dttimestamp from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] group by strname) q on h.strName=q.strName and h.dtTimeStamp=q.dttimestamp\n),\nctetDeployed as (\n\tSELECT StrName, nMajor, nMinor, nStatus\n\t\t\t\t\t\tFROM   (\n\t\t\t\t\t\t   SELECT StrName, nMajor, nMinor, nStatus\n\t\t\t\t\t\t\t\t, row_number() OVER(PARTITION BY StrName ORDER BY nMajor, nMinor DESC) AS rn\n\t\t\t\t\t\t   FROM   [BizTalkRuleEngineDb].[dbo].[re_ruleset]\n\t\t\t\t\t\t   ) sub\n\t\t\t\t\t\tWHERE  rn = 1\n)\nselect count(*) as Count from ctetDeployed d\nwhere nStatus = 0</sqlQuery><warningCondition><expectedValue>0</expectedValue><queryOperator>IsGreaterThan</queryOperator></warningCondition></databaseQueries></DatabaseQueries>"}]},"processMonitors":[],"mbqDataMonitors":[],"tdqDataMonitors":[],"bamDataMonitors":[],"esbDataMonitors":[],"ediDataMonitors":[],"logicAppsDataMonitors":[],"eventLogDataMonitors":[],"overwriteExistingAlarm":0}],"userAccessPoliciesConfigurations":[],"savedQueriesConfigurations":[],"customSQLQueryConfigurations":[{"id":"965f9d53-9649-4adb-b305-1c863bb3d674","name":"BRE Policy statusses","sqlInstance":"BTS2016LAB01","database":"BizTalkRuleEngineDb","sqlQuery":";with \ncteHist as (\n\tselect h.* from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] h\njoin (select strname, max(dttimestamp) as dttimestamp from [BizTalkRuleEngineDb].[dbo].[re_deployment_history] group by strname) q on h.strName=q.strName and h.dtTimeStamp=q.dttimestamp\n),\nctetDeployed as (\n\tSELECT Policy, Status, StrName, nStatus\n\t\t\t\t\t\tFROM   (\n\t\t\t\t\t\t   SELECT StrName, StrName + ' (v' + LTRIM(STR(nMajor)) + '.' + LTRIM(STR(nMinor)) + ')' as 'Policy', nMajor, nMinor, CASE nStatus WHEN 0 THEN 'Saved' WHEN '1' THEN 'Published' END as Status, nStatus\n\t\t\t\t\t\t\t\t, row_number() OVER(PARTITION BY StrName ORDER BY StrName, nMajor, nMinor DESC) AS rn\n\t\t\t\t\t\t   FROM   [BizTalkRuleEngineDb].[dbo].[re_ruleset]\n\t\t\t\t\t\t   ) sub\n\t\t\t\t\t\tWHERE  rn = 1\n)\nselect Policy, Status from ctetDeployed d\nwhere nStatus = 0\nor exists (select 1 from cteHist h  where h.strName=d.strname and bDeployedInd=0)\n","isGlobal":false,"overwriteExistingCustomSQLQuery":0}],"kbArticleConfigurations":{},"bizTalkReportsScheduleConfigurations":[],"userDashboardConfigurations":[],"customWidgetConfigurations":[]}